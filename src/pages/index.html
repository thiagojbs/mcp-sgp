<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SGP MCP Server - Documenta√ß√£o e Playground</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üîå</text></svg>">
  <style>
    :root {
      --primary: #f6821f;
      --primary-dark: #e5720e;
      --secondary: #1a1a2e;
      --bg: #0f0f1a;
      --card-bg: #1a1a2e;
      --text: #e0e0e0;
      --text-muted: #888;
      --success: #10b981;
      --error: #ef4444;
      --warning: #f59e0b;
      --border: #2a2a3e;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Header */
    header {
      background: linear-gradient(135deg, var(--secondary) 0%, var(--bg) 100%);
      border-bottom: 1px solid var(--border);
      padding: 40px 0;
    }

    .header-content {
      display: flex;
      align-items: center;
      gap: 20px;
      flex-wrap: wrap;
    }

    .logo {
      font-size: 48px;
    }

    .header-text h1 {
      font-size: 2.5rem;
      background: linear-gradient(90deg, var(--primary), #ff9f43);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .header-text p {
      color: var(--text-muted);
      font-size: 1.1rem;
    }

    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      background: rgba(16, 185, 129, 0.1);
      border: 1px solid var(--success);
      border-radius: 20px;
      color: var(--success);
      font-size: 0.9rem;
      margin-top: 15px;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      background: var(--success);
      border-radius: 50%;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    /* Navigation */
    nav {
      background: var(--card-bg);
      border-bottom: 1px solid var(--border);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .nav-links {
      display: flex;
      gap: 10px;
      padding: 15px 0;
      overflow-x: auto;
    }

    .nav-link {
      padding: 10px 20px;
      background: transparent;
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text);
      text-decoration: none;
      white-space: nowrap;
      transition: all 0.2s;
      cursor: pointer;
    }

    .nav-link:hover, .nav-link.active {
      background: var(--primary);
      border-color: var(--primary);
      color: white;
    }

    /* Main */
    main {
      padding: 40px 0;
    }

    section {
      display: none;
      animation: fadeIn 0.3s ease;
    }

    section.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    h2 {
      font-size: 1.8rem;
      margin-bottom: 20px;
      color: var(--primary);
    }

    h3 {
      font-size: 1.3rem;
      margin: 25px 0 15px;
      color: var(--text);
    }

    /* Cards */
    .card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 20px;
    }

    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
    }

    .stat-card {
      text-align: center;
      padding: 30px;
    }

    .stat-number {
      font-size: 3rem;
      font-weight: bold;
      color: var(--primary);
    }

    .stat-label {
      color: var(--text-muted);
      margin-top: 5px;
    }

    /* Code blocks */
    pre, code {
      font-family: 'Fira Code', 'Monaco', 'Consolas', monospace;
      background: #0a0a12;
      border-radius: 8px;
    }

    pre {
      padding: 20px;
      overflow-x: auto;
      border: 1px solid var(--border);
      margin: 15px 0;
    }

    code {
      padding: 2px 6px;
      font-size: 0.9em;
    }

    .code-block {
      position: relative;
    }

    .copy-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      padding: 5px 10px;
      background: var(--border);
      border: none;
      border-radius: 4px;
      color: var(--text);
      cursor: pointer;
      font-size: 0.8rem;
    }

    .copy-btn:hover {
      background: var(--primary);
    }

    /* Tools list */
    .tools-category {
      margin-bottom: 30px;
    }

    .category-header {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 15px;
      background: var(--secondary);
      border-radius: 8px 8px 0 0;
      cursor: pointer;
    }

    .category-header:hover {
      background: #252540;
    }

    .category-icon {
      font-size: 1.5rem;
    }

    .category-title {
      flex: 1;
      font-weight: 600;
    }

    .category-count {
      background: var(--primary);
      padding: 2px 10px;
      border-radius: 12px;
      font-size: 0.8rem;
    }

    .tools-list {
      border: 1px solid var(--border);
      border-top: none;
      border-radius: 0 0 8px 8px;
    }

    .tool-item {
      padding: 15px 20px;
      border-bottom: 1px solid var(--border);
      cursor: pointer;
      transition: background 0.2s;
    }

    .tool-item:last-child {
      border-bottom: none;
    }

    .tool-item:hover {
      background: rgba(246, 130, 31, 0.1);
    }

    .tool-name {
      font-family: monospace;
      color: var(--primary);
      font-weight: 600;
    }

    .tool-desc {
      color: var(--text-muted);
      font-size: 0.9rem;
      margin-top: 5px;
    }

    /* Playground */
    .playground-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    @media (max-width: 900px) {
      .playground-container {
        grid-template-columns: 1fr;
      }
    }

    .playground-section h3 {
      margin-top: 0;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    input, select, textarea {
      width: 100%;
      padding: 12px;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text);
      font-size: 1rem;
      font-family: inherit;
    }

    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--primary);
    }

    textarea {
      min-height: 150px;
      font-family: monospace;
      resize: vertical;
    }

    button {
      padding: 12px 24px;
      background: var(--primary);
      border: none;
      border-radius: 8px;
      color: white;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }

    button:hover {
      background: var(--primary-dark);
    }

    button:disabled {
      background: var(--border);
      cursor: not-allowed;
    }

    .btn-secondary {
      background: var(--secondary);
      border: 1px solid var(--border);
    }

    .btn-secondary:hover {
      background: #252540;
    }

    .response-area {
      background: #0a0a12;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 20px;
      min-height: 300px;
      max-height: 500px;
      overflow: auto;
      font-family: monospace;
      font-size: 0.9rem;
      white-space: pre-wrap;
      word-break: break-word;
    }

    .response-success {
      border-color: var(--success);
    }

    .response-error {
      border-color: var(--error);
    }

    /* Endpoints table */
    .endpoints-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }

    .endpoints-table th,
    .endpoints-table td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }

    .endpoints-table th {
      background: var(--secondary);
      color: var(--primary);
    }

    .endpoints-table tr:hover td {
      background: rgba(246, 130, 31, 0.05);
    }

    .method-badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.8rem;
      font-weight: 600;
    }

    .method-get { background: #10b98133; color: #10b981; }
    .method-post { background: #3b82f633; color: #3b82f6; }

    /* Footer */
    footer {
      border-top: 1px solid var(--border);
      padding: 30px 0;
      margin-top: 40px;
      text-align: center;
      color: var(--text-muted);
    }

    footer a {
      color: var(--primary);
      text-decoration: none;
    }

    footer a:hover {
      text-decoration: underline;
    }

    /* Loading spinner */
    .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Tabs */
    .tabs {
      display: flex;
      gap: 5px;
      margin-bottom: 15px;
    }

    .tab {
      padding: 8px 16px;
      background: transparent;
      border: 1px solid var(--border);
      border-radius: 6px;
      color: var(--text-muted);
      cursor: pointer;
      font-size: 0.9rem;
    }

    .tab.active {
      background: var(--primary);
      border-color: var(--primary);
      color: white;
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo">üîå</div>
        <div class="header-text">
          <h1>SGP MCP Server</h1>
          <p>Model Context Protocol Server para integra√ß√£o com o ERP SGP</p>
          <div class="status-badge">
            <span class="status-dot"></span>
            <span>Online - Multi-Tenant</span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <nav>
    <div class="container">
      <div class="nav-links">
        <a class="nav-link active" data-section="overview">üìä Vis√£o Geral</a>
        <a class="nav-link" data-section="quickstart">üöÄ In√≠cio R√°pido</a>
        <a class="nav-link" data-section="tools">üîß Ferramentas</a>
        <a class="nav-link" data-section="playground">üß™ Playground</a>
        <a class="nav-link" data-section="api">üì° API</a>
      </div>
    </div>
  </nav>

  <main class="container">
    <!-- Overview Section -->
    <section id="overview" class="active">
      <h2>Vis√£o Geral</h2>

      <div class="card-grid">
        <div class="card stat-card">
          <div class="stat-number" id="tools-count">215</div>
          <div class="stat-label">Ferramentas Dispon√≠veis</div>
        </div>
        <div class="card stat-card">
          <div class="stat-number">14</div>
          <div class="stat-label">Categorias</div>
        </div>
        <div class="card stat-card">
          <div class="stat-number">‚àû</div>
          <div class="stat-label">SGPs Suportados</div>
        </div>
      </div>

      <div class="card">
        <h3>O que √© o SGP MCP Server?</h3>
        <p>Um servidor MCP (Model Context Protocol) que permite que assistentes de IA, como o Claude, interajam diretamente com o sistema SGP (Sistema de Gest√£o para Provedores de Internet).</p>

        <h3>Funcionalidades</h3>
        <ul style="margin-left: 20px; color: var(--text-muted);">
          <li><strong>Multi-Tenant:</strong> Suporta m√∫ltiplos SGPs - cada usu√°rio configura suas pr√≥prias credenciais</li>
          <li><strong>Clientes e Contratos:</strong> Consulta, listagem e detalhes completos</li>
          <li><strong>Financeiro:</strong> Faturas, boletos, remessa/retorno banc√°rio</li>
          <li><strong>Suporte:</strong> CRUD completo de chamados, categorias, prioridades e anexos</li>
          <li><strong>Ordens de Servi√ßo:</strong> CRUD completo, agendamento, t√©cnicos e anexos</li>
          <li><strong>FTTH:</strong> CRUD de ONUs, OLTs, caixas e splitters</li>
          <li><strong>Estoque:</strong> Produtos, movimenta√ß√µes, fornecedores e invent√°rio</li>
          <li><strong>RADIUS:</strong> Usu√°rios, grupos, NAS, sess√µes e accounting</li>
          <li><strong>Termos de Aceite:</strong> Gest√£o de termos, vers√µes e aceites de clientes</li>
          <li><strong>URA:</strong> Integra√ß√£o com atendimento telef√¥nico automatizado</li>
          <li><strong>Pr√©-Cadastros:</strong> Gest√£o de leads e prospectos</li>
          <li><strong>Outros:</strong> Cidades, estados, CEP, logs, notifica√ß√µes, configura√ß√µes e relat√≥rios</li>
        </ul>
      </div>

      <div class="card">
        <h3>Endpoints</h3>
        <table class="endpoints-table">
          <thead>
            <tr>
              <th>M√©todo</th>
              <th>Endpoint</th>
              <th>Descri√ß√£o</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><span class="method-badge method-get">GET</span></td>
              <td><code>/</code></td>
              <td>Esta p√°gina de documenta√ß√£o</td>
            </tr>
            <tr>
              <td><span class="method-badge method-get">GET</span></td>
              <td><code>/health</code></td>
              <td>Health check (JSON)</td>
            </tr>
            <tr>
              <td><span class="method-badge method-get">GET</span></td>
              <td><code>/tools</code></td>
              <td>Lista todas as ferramentas dispon√≠veis</td>
            </tr>
            <tr>
              <td><span class="method-badge method-get">GET</span></td>
              <td><code>/sse</code></td>
              <td>Endpoint MCP (Server-Sent Events)</td>
            </tr>
            <tr>
              <td><span class="method-badge method-post">POST</span></td>
              <td><code>/mcp</code></td>
              <td>Endpoint MCP (Streamable HTTP)</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Quickstart Section -->
    <section id="quickstart">
      <h2>üöÄ In√≠cio R√°pido</h2>

      <div class="card">
        <h3>1. Conectar ao MCP Server</h3>
        <p>Use a URL SSE para conectar seu cliente MCP:</p>
        <div class="code-block">
          <pre>https://mcp-sgp.thiagojbs.workers.dev/sse</pre>
          <button class="copy-btn" onclick="copyToClipboard('https://mcp-sgp.thiagojbs.workers.dev/sse')">Copiar</button>
        </div>
      </div>

      <div class="card">
        <h3>2. Configurar Credenciais do SGP</h3>
        <p>O primeiro passo √© sempre configurar o SGP que ser√° usado:</p>
        <div class="code-block">
          <pre>{
  "tool": "sgp_configurar",
  "params": {
    "sgp_url": "https://seuprovedor.sgp.net.br/api",
    "auth_type": "token",
    "token": "SEU_TOKEN_AQUI",
    "app": "NOME_DO_APP"
  }
}</pre>
          <button class="copy-btn" onclick="copyToClipboard(this.previousElementSibling.textContent)">Copiar</button>
        </div>
      </div>

      <div class="card">
        <h3>3. Usar as Ferramentas</h3>
        <p>Ap√≥s configurar, voc√™ pode usar qualquer ferramenta. Exemplo:</p>
        <div class="code-block">
          <pre>// Consultar um cliente por CPF
{
  "tool": "sgp_consultar_cliente",
  "params": {
    "cpfcnpj": "12345678900"
  }
}

// Listar faturas em aberto
{
  "tool": "sgp_listar_faturas",
  "params": {
    "status": "aberta"
  }
}

// Abrir um chamado
{
  "tool": "sgp_abrir_chamado",
  "params": {
    "cliente_id": 123,
    "categoria_id": 1,
    "titulo": "Problema de conex√£o",
    "descricao": "Cliente sem internet desde ontem"
  }
}</pre>
        </div>
      </div>

      <div class="card">
        <h3>Configura√ß√£o no Claude Desktop</h3>
        <p>Adicione ao arquivo <code>claude_desktop_config.json</code>:</p>
        <div class="code-block">
          <pre>{
  "mcpServers": {
    "sgp": {
      "command": "npx",
      "args": [
        "mcp-remote",
        "https://mcp-sgp.thiagojbs.workers.dev/sse"
      ]
    }
  }
}</pre>
          <button class="copy-btn" onclick="copyToClipboard(this.previousElementSibling.textContent)">Copiar</button>
        </div>
      </div>
    </section>

    <!-- Tools Section -->
    <section id="tools">
      <h2>üîß Ferramentas Dispon√≠veis</h2>
      <p style="color: var(--text-muted); margin-bottom: 20px;">Clique em uma categoria para expandir e ver todas as ferramentas.</p>

      <div id="tools-list-container">
        <!-- Ser√° preenchido via JavaScript -->
        <div style="text-align: center; padding: 40px;">
          <div class="spinner"></div>
          <p style="margin-top: 15px; color: var(--text-muted);">Carregando ferramentas...</p>
        </div>
      </div>
    </section>

    <!-- Playground Section -->
    <section id="playground">
      <h2>üß™ Playground</h2>
      <p style="color: var(--text-muted); margin-bottom: 20px;">Teste as ferramentas do MCP Server diretamente aqui.</p>

      <div class="playground-container">
        <div class="card playground-section">
          <h3>Configura√ß√£o</h3>

          <div class="form-group">
            <label>URL do SGP</label>
            <input type="text" id="sgp-url" placeholder="https://demo.sgp.net.br/api" value="https://demo.sgp.net.br/api">
          </div>

          <div class="form-group">
            <label>Tipo de Autentica√ß√£o</label>
            <select id="auth-type">
              <option value="token">Token + App</option>
              <option value="basic">Usu√°rio e Senha</option>
            </select>
          </div>

          <div id="token-auth">
            <div class="form-group">
              <label>Token</label>
              <input type="text" id="sgp-token" placeholder="Seu token de API">
            </div>
            <div class="form-group">
              <label>App</label>
              <input type="text" id="sgp-app" placeholder="Nome do aplicativo">
            </div>
          </div>

          <div id="basic-auth" style="display: none;">
            <div class="form-group">
              <label>Usu√°rio</label>
              <input type="text" id="sgp-username" placeholder="Usu√°rio do SGP">
            </div>
            <div class="form-group">
              <label>Senha</label>
              <input type="password" id="sgp-password" placeholder="Senha">
            </div>
          </div>

          <button id="btn-configure" onclick="configureSGP()">Configurar SGP</button>
        </div>

        <div class="card playground-section">
          <h3>Testar Ferramenta</h3>

          <div class="form-group">
            <label>Ferramenta</label>
            <select id="tool-select">
              <option value="">Selecione uma ferramenta...</option>
            </select>
          </div>

          <div class="form-group">
            <label>Par√¢metros (JSON)</label>
            <textarea id="tool-params" placeholder='{"cpfcnpj": "12345678900"}'></textarea>
          </div>

          <div style="display: flex; gap: 10px;">
            <button id="btn-execute" onclick="executeTool()">Executar</button>
            <button class="btn-secondary" onclick="clearResponse()">Limpar</button>
          </div>
        </div>
      </div>

      <div class="card" style="margin-top: 20px;">
        <h3>Resposta</h3>
        <div id="response-area" class="response-area">
          <span style="color: var(--text-muted);">A resposta aparecer√° aqui...</span>
        </div>
      </div>
    </section>

    <!-- API Section -->
    <section id="api">
      <h2>üì° API Reference</h2>

      <div class="card">
        <h3>Autentica√ß√£o</h3>
        <p>A API do SGP suporta dois m√©todos de autentica√ß√£o:</p>

        <h4 style="margin-top: 20px; color: var(--primary);">Token + App (Recomendado)</h4>
        <div class="code-block">
          <pre>GET /api/endpoint?token=SEU_TOKEN&app=NOME_APP</pre>
        </div>

        <h4 style="margin-top: 20px; color: var(--primary);">Basic Authentication</h4>
        <div class="code-block">
          <pre>Authorization: Basic base64(usuario:senha)</pre>
        </div>
      </div>

      <div class="card">
        <h3>Formato de Resposta</h3>
        <p>Todas as respostas seguem o formato:</p>
        <div class="code-block">
          <pre>{
  "status": "success" | "error",
  "message": "Mensagem descritiva",
  "data": { ... }
}</pre>
        </div>
      </div>

      <div class="card">
        <h3>Pagina√ß√£o</h3>
        <p>Endpoints que retornam listas suportam pagina√ß√£o:</p>
        <div class="code-block">
          <pre>?page=1&per_page=20</pre>
        </div>
        <p style="margin-top: 10px; color: var(--text-muted);">M√°ximo de 100 itens por p√°gina.</p>
      </div>

      <div class="card">
        <h3>Rate Limits</h3>
        <table class="endpoints-table">
          <thead>
            <tr>
              <th>Tipo de Autentica√ß√£o</th>
              <th>Limite</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Token</td>
              <td>300 requisi√ß√µes/minuto</td>
            </tr>
            <tr>
              <td>Basic Auth</td>
              <td>100 requisi√ß√µes/minuto</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
  </main>

  <footer>
    <div class="container">
      <p>SGP MCP Server v1.0.0 | Desenvolvido com ‚ù§Ô∏è para provedores de internet</p>
      <p style="margin-top: 10px;">
        <a href="https://github.com/thiagojbs/mcp-sgp" target="_blank">GitHub</a> ‚Ä¢
        <a href="https://documenter.getpostman.com/view/6682240/UzXKVyUs" target="_blank">Documenta√ß√£o SGP</a>
      </p>
    </div>
  </footer>

  <script>
    // Navigation
    document.querySelectorAll('.nav-link').forEach(link => {
      link.addEventListener('click', () => {
        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
        document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
        link.classList.add('active');
        document.getElementById(link.dataset.section).classList.add('active');
      });
    });

    // Auth type toggle
    document.getElementById('auth-type').addEventListener('change', function() {
      document.getElementById('token-auth').style.display = this.value === 'token' ? 'block' : 'none';
      document.getElementById('basic-auth').style.display = this.value === 'basic' ? 'block' : 'none';
    });

    // Copy to clipboard
    function copyToClipboard(text) {
      navigator.clipboard.writeText(text.trim());
      alert('Copiado!');
    }

    // Tools data
    const toolsData = {
      "Configura√ß√£o": {
        icon: "‚öôÔ∏è",
        tools: [
          { name: "sgp_configurar", desc: "Configura as credenciais do SGP (CHAMAR PRIMEIRO)" },
          { name: "sgp_status_conexao", desc: "Verifica status da conex√£o com o SGP" }
        ]
      },
      "Clientes": {
        icon: "üë•",
        tools: [
          { name: "sgp_consultar_cliente", desc: "Consulta clientes por CPF/CNPJ, telefone ou nome" },
          { name: "sgp_detalhes_cliente", desc: "Retorna detalhes completos de um cliente" }
        ]
      },
      "Contratos": {
        icon: "üìÑ",
        tools: [
          { name: "sgp_listar_contratos", desc: "Lista contratos com filtros" },
          { name: "sgp_detalhes_contrato", desc: "Detalhes de um contrato" },
          { name: "sgp_criar_contrato", desc: "Cria novo contrato" },
          { name: "sgp_atualizar_contrato", desc: "Atualiza contrato" },
          { name: "sgp_suspender_contrato", desc: "Suspende contrato" },
          { name: "sgp_reativar_contrato", desc: "Reativa contrato" },
          { name: "sgp_cancelar_contrato", desc: "Cancela contrato" },
          { name: "sgp_consultar_contrato_resumido", desc: "Consulta r√°pida via URA" }
        ]
      },
      "Faturas": {
        icon: "üí∞",
        tools: [
          { name: "sgp_listar_faturas", desc: "Lista faturas com filtros" },
          { name: "sgp_detalhes_fatura", desc: "Detalhes de uma fatura" },
          { name: "sgp_segunda_via_fatura", desc: "Gera segunda via" },
          { name: "sgp_faturas_contrato", desc: "Faturas de um contrato" },
          { name: "sgp_listar_boletos", desc: "Lista boletos" },
          { name: "sgp_detalhes_boleto", desc: "Detalhes de um boleto" },
          { name: "sgp_gerar_boleto", desc: "Gera novo boleto" },
          { name: "sgp_cancelar_boleto", desc: "Cancela boleto" }
        ]
      },
      "Chamados": {
        icon: "üé´",
        tools: [
          { name: "sgp_listar_chamados", desc: "Lista chamados com filtros" },
          { name: "sgp_detalhes_chamado", desc: "Detalhes de um chamado" },
          { name: "sgp_abrir_chamado", desc: "Abre novo chamado" },
          { name: "sgp_atualizar_chamado", desc: "Atualiza chamado" },
          { name: "sgp_excluir_chamado", desc: "Exclui chamado" },
          { name: "sgp_cancelar_chamado", desc: "Cancela chamado" },
          { name: "sgp_iniciar_atendimento_chamado", desc: "Inicia atendimento" },
          { name: "sgp_interagir_chamado", desc: "Adiciona intera√ß√£o" },
          { name: "sgp_atribuir_chamado", desc: "Atribui a atendente" },
          { name: "sgp_finalizar_chamado", desc: "Finaliza atendimento" },
          { name: "sgp_listar_interacoes_chamado", desc: "Lista intera√ß√µes" },
          { name: "sgp_adicionar_anexo_chamado", desc: "Adiciona anexo" },
          { name: "sgp_listar_anexos_chamado", desc: "Lista anexos" },
          { name: "sgp_remover_anexo_chamado", desc: "Remove anexo" },
          { name: "sgp_listar_categorias_chamado", desc: "Lista categorias" },
          { name: "sgp_cadastrar_categoria_chamado", desc: "Cadastra categoria" },
          { name: "sgp_detalhes_categoria_chamado", desc: "Detalhes categoria" },
          { name: "sgp_atualizar_categoria_chamado", desc: "Atualiza categoria" },
          { name: "sgp_excluir_categoria_chamado", desc: "Exclui categoria" },
          { name: "sgp_listar_prioridades_chamado", desc: "Lista prioridades" },
          { name: "sgp_cadastrar_prioridade_chamado", desc: "Cadastra prioridade" },
          { name: "sgp_detalhes_prioridade_chamado", desc: "Detalhes prioridade" },
          { name: "sgp_atualizar_prioridade_chamado", desc: "Atualiza prioridade" },
          { name: "sgp_excluir_prioridade_chamado", desc: "Exclui prioridade" }
        ]
      },
      "Ordens de Servi√ßo": {
        icon: "üîß",
        tools: [
          { name: "sgp_listar_ordens_servico", desc: "Lista OS com filtros" },
          { name: "sgp_detalhes_ordem_servico", desc: "Detalhes de uma OS" },
          { name: "sgp_criar_ordem_servico", desc: "Cria nova OS" },
          { name: "sgp_atualizar_ordem_servico", desc: "Atualiza OS" },
          { name: "sgp_excluir_ordem_servico", desc: "Exclui OS" },
          { name: "sgp_cancelar_ordem_servico", desc: "Cancela OS" },
          { name: "sgp_iniciar_ordem_servico", desc: "Inicia execu√ß√£o" },
          { name: "sgp_pausar_ordem_servico", desc: "Pausa execu√ß√£o" },
          { name: "sgp_retomar_ordem_servico", desc: "Retoma execu√ß√£o" },
          { name: "sgp_finalizar_ordem_servico", desc: "Finaliza OS" },
          { name: "sgp_atualizar_status_ordem", desc: "Atualiza status" },
          { name: "sgp_reagendar_ordem", desc: "Reagenda OS" },
          { name: "sgp_transferir_ordem", desc: "Transfere para t√©cnico" },
          { name: "sgp_comentario_ordem", desc: "Adiciona coment√°rio" },
          { name: "sgp_listar_comentarios_ordem", desc: "Lista coment√°rios" },
          { name: "sgp_adicionar_anexo_os", desc: "Adiciona anexo" },
          { name: "sgp_listar_anexos_os", desc: "Lista anexos" },
          { name: "sgp_remover_anexo_os", desc: "Remove anexo" },
          { name: "sgp_listar_tipos_os", desc: "Lista tipos de OS" },
          { name: "sgp_cadastrar_tipo_os", desc: "Cadastra tipo" },
          { name: "sgp_detalhes_tipo_os", desc: "Detalhes tipo" },
          { name: "sgp_atualizar_tipo_os", desc: "Atualiza tipo" },
          { name: "sgp_excluir_tipo_os", desc: "Exclui tipo" },
          { name: "sgp_listar_tecnicos", desc: "Lista t√©cnicos" },
          { name: "sgp_agenda_tecnico", desc: "Agenda de t√©cnico" }
        ]
      },
      "FTTH": {
        icon: "üåê",
        tools: [
          { name: "sgp_listar_onus", desc: "Lista ONUs" },
          { name: "sgp_detalhes_onu", desc: "Detalhes de ONU" },
          { name: "sgp_cadastrar_onu", desc: "Cadastra ONU" },
          { name: "sgp_atualizar_onu", desc: "Atualiza ONU" },
          { name: "sgp_excluir_onu", desc: "Exclui ONU" },
          { name: "sgp_provisionar_onu", desc: "Provisiona ONU" },
          { name: "sgp_desprovisionar_onu", desc: "Desprovisiona ONU" },
          { name: "sgp_reiniciar_onu", desc: "Reinicia ONU" },
          { name: "sgp_status_onu", desc: "Status em tempo real" },
          { name: "sgp_listar_olts", desc: "Lista OLTs" },
          { name: "sgp_detalhes_olt", desc: "Detalhes de OLT" },
          { name: "sgp_cadastrar_olt", desc: "Cadastra OLT" },
          { name: "sgp_atualizar_olt", desc: "Atualiza OLT" },
          { name: "sgp_excluir_olt", desc: "Exclui OLT" },
          { name: "sgp_listar_caixas", desc: "Lista caixas" },
          { name: "sgp_detalhes_caixa", desc: "Detalhes de caixa" },
          { name: "sgp_cadastrar_caixa", desc: "Cadastra caixa" },
          { name: "sgp_atualizar_caixa", desc: "Atualiza caixa" },
          { name: "sgp_excluir_caixa", desc: "Exclui caixa" },
          { name: "sgp_listar_splitters", desc: "Lista splitters" },
          { name: "sgp_detalhes_splitter", desc: "Detalhes de splitter" },
          { name: "sgp_cadastrar_splitter", desc: "Cadastra splitter" },
          { name: "sgp_atualizar_splitter", desc: "Atualiza splitter" },
          { name: "sgp_excluir_splitter", desc: "Exclui splitter" }
        ]
      },
      "Estoque": {
        icon: "üì¶",
        tools: [
          { name: "sgp_listar_produtos", desc: "Lista produtos" },
          { name: "sgp_detalhes_produto", desc: "Detalhes de produto" },
          { name: "sgp_cadastrar_produto", desc: "Cadastra produto" },
          { name: "sgp_atualizar_produto", desc: "Atualiza produto" },
          { name: "sgp_excluir_produto", desc: "Exclui produto" },
          { name: "sgp_listar_movimentacoes", desc: "Lista movimenta√ß√µes" },
          { name: "sgp_detalhes_movimentacao", desc: "Detalhes movimenta√ß√£o" },
          { name: "sgp_cadastrar_movimentacao", desc: "Registra entrada/sa√≠da" },
          { name: "sgp_cancelar_movimentacao", desc: "Cancela movimenta√ß√£o" },
          { name: "sgp_listar_fornecedores", desc: "Lista fornecedores" },
          { name: "sgp_detalhes_fornecedor", desc: "Detalhes fornecedor" },
          { name: "sgp_cadastrar_fornecedor", desc: "Cadastra fornecedor" },
          { name: "sgp_atualizar_fornecedor", desc: "Atualiza fornecedor" },
          { name: "sgp_excluir_fornecedor", desc: "Exclui fornecedor" },
          { name: "sgp_listar_categorias_estoque", desc: "Lista categorias" },
          { name: "sgp_detalhes_categoria_estoque", desc: "Detalhes categoria" },
          { name: "sgp_cadastrar_categoria_estoque", desc: "Cadastra categoria" },
          { name: "sgp_atualizar_categoria_estoque", desc: "Atualiza categoria" },
          { name: "sgp_excluir_categoria_estoque", desc: "Exclui categoria" },
          { name: "sgp_listar_inventarios", desc: "Lista invent√°rios" },
          { name: "sgp_detalhes_inventario", desc: "Detalhes de invent√°rio" },
          { name: "sgp_iniciar_inventario", desc: "Inicia invent√°rio" },
          { name: "sgp_finalizar_inventario", desc: "Finaliza invent√°rio" },
          { name: "sgp_cancelar_inventario", desc: "Cancela invent√°rio" }
        ]
      },
      "RADIUS": {
        icon: "üì°",
        tools: [
          { name: "sgp_listar_usuarios_radius", desc: "Lista usu√°rios RADIUS" },
          { name: "sgp_detalhes_usuario_radius", desc: "Detalhes de usu√°rio" },
          { name: "sgp_cadastrar_usuario_radius", desc: "Cadastra usu√°rio" },
          { name: "sgp_atualizar_usuario_radius", desc: "Atualiza usu√°rio" },
          { name: "sgp_excluir_usuario_radius", desc: "Exclui usu√°rio" },
          { name: "sgp_bloquear_usuario_radius", desc: "Bloqueia usu√°rio" },
          { name: "sgp_desbloquear_usuario_radius", desc: "Desbloqueia usu√°rio" },
          { name: "sgp_resetar_senha_radius", desc: "Reseta senha" },
          { name: "sgp_listar_sessoes_radius", desc: "Lista sess√µes" },
          { name: "sgp_detalhes_sessao_radius", desc: "Detalhes de sess√£o" },
          { name: "sgp_encerrar_sessao_radius", desc: "Encerra sess√£o" },
          { name: "sgp_listar_grupos_radius", desc: "Lista grupos" },
          { name: "sgp_detalhes_grupo_radius", desc: "Detalhes grupo" },
          { name: "sgp_cadastrar_grupo_radius", desc: "Cadastra grupo" },
          { name: "sgp_atualizar_grupo_radius", desc: "Atualiza grupo" },
          { name: "sgp_excluir_grupo_radius", desc: "Exclui grupo" },
          { name: "sgp_listar_nas", desc: "Lista NAS" },
          { name: "sgp_detalhes_nas", desc: "Detalhes de NAS" },
          { name: "sgp_cadastrar_nas", desc: "Cadastra NAS" },
          { name: "sgp_atualizar_nas", desc: "Atualiza NAS" },
          { name: "sgp_excluir_nas", desc: "Exclui NAS" },
          { name: "sgp_listar_accounting_radius", desc: "Lista accounting" },
          { name: "sgp_detalhes_accounting_radius", desc: "Detalhes accounting" }
        ]
      },
      "Remessa/Retorno": {
        icon: "üè¶",
        tools: [
          { name: "sgp_gerar_remessa", desc: "Gera arquivo de remessa CNAB" },
          { name: "sgp_listar_remessas", desc: "Lista remessas geradas" },
          { name: "sgp_download_remessa", desc: "Download arquivo remessa" },
          { name: "sgp_processar_retorno", desc: "Processa arquivo de retorno" },
          { name: "sgp_listar_retornos", desc: "Lista retornos processados" },
          { name: "sgp_detalhes_retorno", desc: "Detalhes de retorno" },
          { name: "sgp_listar_boletos_remessa", desc: "Boletos de uma remessa" },
          { name: "sgp_gerar_boleto", desc: "Gera boleto individual" },
          { name: "sgp_detalhes_boleto", desc: "Detalhes de boleto" },
          { name: "sgp_cancelar_boleto", desc: "Cancela boleto" }
        ]
      },
      "Termos de Aceite": {
        icon: "üìã",
        tools: [
          { name: "sgp_listar_termos", desc: "Lista termos de aceite" },
          { name: "sgp_detalhes_termo", desc: "Detalhes de um termo" },
          { name: "sgp_cadastrar_termo", desc: "Cadastra novo termo" },
          { name: "sgp_atualizar_termo", desc: "Atualiza termo" },
          { name: "sgp_excluir_termo", desc: "Exclui termo" },
          { name: "sgp_listar_versoes_termo", desc: "Lista vers√µes de termo" },
          { name: "sgp_detalhes_versao_termo", desc: "Detalhes de vers√£o" },
          { name: "sgp_cadastrar_versao_termo", desc: "Cadastra vers√£o" },
          { name: "sgp_atualizar_versao_termo", desc: "Atualiza vers√£o" },
          { name: "sgp_ativar_versao_termo", desc: "Ativa vers√£o do termo" },
          { name: "sgp_listar_aceites_termo", desc: "Lista aceites de clientes" },
          { name: "sgp_detalhes_aceite_termo", desc: "Detalhes de aceite" },
          { name: "sgp_registrar_aceite_termo", desc: "Registra aceite" },
          { name: "sgp_verificar_aceite_cliente", desc: "Verifica se cliente aceitou" },
          { name: "sgp_revogar_aceite_termo", desc: "Revoga aceite" }
        ]
      },
      "URA": {
        icon: "üìû",
        tools: [
          { name: "sgp_ura_consultar_cliente", desc: "Consulta cliente pela URA" },
          { name: "sgp_ura_consultar_contrato", desc: "Consulta contrato pela URA" },
          { name: "sgp_ura_listar_faturas", desc: "Lista faturas pela URA" },
          { name: "sgp_ura_detalhes_fatura", desc: "Detalhes fatura pela URA" },
          { name: "sgp_ura_abrir_chamado", desc: "Abre chamado pela URA" },
          { name: "sgp_ura_consultar_chamado", desc: "Consulta chamado pela URA" },
          { name: "sgp_ura_listar_chamados_cliente", desc: "Lista chamados do cliente" },
          { name: "sgp_ura_registrar_atendimento", desc: "Registra atendimento URA" },
          { name: "sgp_ura_consultar_atendimento", desc: "Consulta atendimento" },
          { name: "sgp_ura_listar_atendimentos_cliente", desc: "Lista atendimentos" },
          { name: "sgp_ura_listar_menu", desc: "Lista menu da URA" },
          { name: "sgp_ura_status_filas", desc: "Status das filas" }
        ]
      },
      "Pr√©-Cadastros": {
        icon: "üìù",
        tools: [
          { name: "sgp_listar_pre_cadastros", desc: "Lista pr√©-cadastros" },
          { name: "sgp_detalhes_pre_cadastro", desc: "Detalhes de pr√©-cadastro" },
          { name: "sgp_cadastrar_pre_cadastro", desc: "Cadastra lead/prospecto" },
          { name: "sgp_atualizar_pre_cadastro", desc: "Atualiza pr√©-cadastro" },
          { name: "sgp_excluir_pre_cadastro", desc: "Exclui pr√©-cadastro" },
          { name: "sgp_converter_pre_cadastro", desc: "Converte em cliente" },
          { name: "sgp_cancelar_pre_cadastro", desc: "Cancela pr√©-cadastro" },
          { name: "sgp_listar_origens_pre_cadastro", desc: "Lista origens" },
          { name: "sgp_detalhes_origem_pre_cadastro", desc: "Detalhes origem" },
          { name: "sgp_cadastrar_origem_pre_cadastro", desc: "Cadastra origem" },
          { name: "sgp_atualizar_origem_pre_cadastro", desc: "Atualiza origem" },
          { name: "sgp_excluir_origem_pre_cadastro", desc: "Exclui origem" },
          { name: "sgp_listar_status_pre_cadastro", desc: "Lista status" },
          { name: "sgp_detalhes_status_pre_cadastro", desc: "Detalhes status" },
          { name: "sgp_cadastrar_status_pre_cadastro", desc: "Cadastra status" },
          { name: "sgp_atualizar_status_pre_cadastro", desc: "Atualiza status" },
          { name: "sgp_excluir_status_pre_cadastro", desc: "Exclui status" }
        ]
      },
      "Central do Assinante": {
        icon: "üë§",
        tools: [
          { name: "central_contratos_listar", desc: "Lista contratos do assinante" },
          { name: "central_contrato_detalhes", desc: "Detalhes do contrato" },
          { name: "central_faturas_listar", desc: "Lista faturas do assinante" },
          { name: "central_fatura_detalhes", desc: "Detalhes da fatura" },
          { name: "central_fatura_segunda_via", desc: "Gera segunda via de fatura" },
          { name: "central_chamados_listar", desc: "Lista chamados do assinante" },
          { name: "central_chamado_abrir", desc: "Abre chamado de suporte" },
          { name: "central_chamado_detalhes", desc: "Detalhes do chamado" },
          { name: "central_chamado_interagir", desc: "Interage em chamado" },
          { name: "central_planos_listar", desc: "Lista planos dispon√≠veis" },
          { name: "central_plano_solicitar_upgrade", desc: "Solicita upgrade de plano" },
          { name: "central_consumo_consultar", desc: "Consulta consumo de dados" },
          { name: "central_perfil_consultar", desc: "Consulta perfil do assinante" },
          { name: "central_perfil_atualizar", desc: "Atualiza dados do perfil" },
          { name: "central_senha_alterar", desc: "Altera senha de acesso" }
        ]
      },
      "Outros": {
        icon: "üîπ",
        tools: [
          { name: "sgp_listar_cidades", desc: "Lista cidades" },
          { name: "sgp_listar_estados", desc: "Lista estados" },
          { name: "sgp_consultar_cep", desc: "Consulta CEP" },
          { name: "sgp_listar_logs", desc: "Lista logs do sistema" },
          { name: "sgp_listar_notificacoes", desc: "Lista notifica√ß√µes" },
          { name: "sgp_marcar_notificacao_lida", desc: "Marca notifica√ß√£o lida" },
          { name: "sgp_marcar_todas_notificacoes_lidas", desc: "Marca todas lidas" },
          { name: "sgp_listar_configuracoes", desc: "Lista configura√ß√µes" },
          { name: "sgp_obter_configuracao", desc: "Obt√©m configura√ß√£o" },
          { name: "sgp_atualizar_configuracao", desc: "Atualiza configura√ß√£o" },
          { name: "sgp_listar_relatorios", desc: "Lista relat√≥rios" },
          { name: "sgp_gerar_relatorio", desc: "Gera relat√≥rio" }
        ]
      }
    };

    // Render tools list
    function renderToolsList() {
      const container = document.getElementById('tools-list-container');
      let html = '';
      let totalTools = 0;
      const toolSelect = document.getElementById('tool-select');

      for (const [category, data] of Object.entries(toolsData)) {
        totalTools += data.tools.length;
        html += `
          <div class="tools-category">
            <div class="category-header" onclick="this.nextElementSibling.style.display = this.nextElementSibling.style.display === 'none' ? 'block' : 'none'">
              <span class="category-icon">${data.icon}</span>
              <span class="category-title">${category}</span>
              <span class="category-count">${data.tools.length}</span>
            </div>
            <div class="tools-list" style="display: none;">
              ${data.tools.map(tool => `
                <div class="tool-item" onclick="selectTool('${tool.name}')">
                  <div class="tool-name">${tool.name}</div>
                  <div class="tool-desc">${tool.desc}</div>
                </div>
              `).join('')}
            </div>
          </div>
        `;

        // Add to select
        const optgroup = document.createElement('optgroup');
        optgroup.label = category;
        data.tools.forEach(tool => {
          const option = document.createElement('option');
          option.value = tool.name;
          option.textContent = tool.name;
          optgroup.appendChild(option);
        });
        toolSelect.appendChild(optgroup);
      }

      container.innerHTML = html;
      document.getElementById('tools-count').textContent = totalTools;
    }

    // Select tool
    function selectTool(name) {
      document.getElementById('tool-select').value = name;
      document.querySelector('[data-section="playground"]').click();

      // Set default params
      const defaultParams = getDefaultParams(name);
      document.getElementById('tool-params').value = JSON.stringify(defaultParams, null, 2);
    }

    function getDefaultParams(toolName) {
      const params = {
        'sgp_configurar': { sgp_url: 'https://demo.sgp.net.br/api', auth_type: 'token', token: '', app: '' },
        'sgp_consultar_cliente': { cpfcnpj: '' },
        'sgp_listar_contratos': { status: 'ativo', page: 1 },
        'sgp_listar_faturas': { status: 'aberta', page: 1 },
        'sgp_listar_chamados': { status: 'aberto', page: 1 },
        'sgp_abrir_chamado': { cliente_id: 0, categoria_id: 0, titulo: '', descricao: '' },
        'sgp_listar_ordens_servico': { status: 'pendente', page: 1 },
        'sgp_listar_onus': { status: 'online', page: 1 },
        'sgp_listar_produtos': { page: 1 },
        'sgp_listar_usuarios_radius': { status: 'ativo', page: 1 }
      };
      return params[toolName] || {};
    }

    // Configure SGP
    async function configureSGP() {
      const btn = document.getElementById('btn-configure');
      btn.innerHTML = '<span class="spinner"></span> Configurando...';
      btn.disabled = true;

      const config = {
        sgp_url: document.getElementById('sgp-url').value,
        auth_type: document.getElementById('auth-type').value
      };

      if (config.auth_type === 'token') {
        config.token = document.getElementById('sgp-token').value;
        config.app = document.getElementById('sgp-app').value;
      } else {
        config.username = document.getElementById('sgp-username').value;
        config.password = document.getElementById('sgp-password').value;
      }

      // Store config
      localStorage.setItem('sgp_config', JSON.stringify(config));

      showResponse({
        status: 'success',
        message: 'Configura√ß√£o salva localmente!',
        config: { ...config, token: config.token ? '***' : undefined, password: config.password ? '***' : undefined }
      }, true);

      btn.innerHTML = 'Configurar SGP';
      btn.disabled = false;
    }

    // Execute tool
    async function executeTool() {
      const btn = document.getElementById('btn-execute');
      const tool = document.getElementById('tool-select').value;
      const paramsText = document.getElementById('tool-params').value;

      if (!tool) {
        alert('Selecione uma ferramenta');
        return;
      }

      let params = {};
      try {
        if (paramsText.trim()) {
          params = JSON.parse(paramsText);
        }
      } catch (e) {
        showResponse({ status: 'error', message: 'JSON inv√°lido nos par√¢metros' }, false);
        return;
      }

      btn.innerHTML = '<span class="spinner"></span> Executando...';
      btn.disabled = true;

      // Get stored config
      const storedConfig = localStorage.getItem('sgp_config');
      if (storedConfig && tool !== 'sgp_configurar') {
        const config = JSON.parse(storedConfig);
        params = { ...config, ...params };
      }

      try {
        // Simulate API call (in real implementation, this would call the MCP endpoint)
        const response = await fetch('/api/test', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ tool, params })
        });

        const data = await response.json();
        showResponse(data, data.status === 'success');
      } catch (error) {
        showResponse({
          status: 'info',
          message: 'Este playground √© apenas para visualiza√ß√£o.',
          note: 'Para executar as ferramentas de verdade, conecte um cliente MCP ao endpoint /sse',
          tool_called: tool,
          params_sent: params
        }, true);
      }

      btn.innerHTML = 'Executar';
      btn.disabled = false;
    }

    function showResponse(data, success) {
      const area = document.getElementById('response-area');
      area.textContent = JSON.stringify(data, null, 2);
      area.className = 'response-area ' + (success ? 'response-success' : 'response-error');
    }

    function clearResponse() {
      const area = document.getElementById('response-area');
      area.textContent = 'A resposta aparecer√° aqui...';
      area.className = 'response-area';
    }

    // Load stored config
    function loadStoredConfig() {
      const stored = localStorage.getItem('sgp_config');
      if (stored) {
        const config = JSON.parse(stored);
        document.getElementById('sgp-url').value = config.sgp_url || '';
        document.getElementById('auth-type').value = config.auth_type || 'token';
        if (config.auth_type === 'basic') {
          document.getElementById('token-auth').style.display = 'none';
          document.getElementById('basic-auth').style.display = 'block';
        }
      }
    }

    // Initialize
    renderToolsList();
    loadStoredConfig();
  </script>
</body>
</html>
